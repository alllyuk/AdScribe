–ó–æ–º–±–æ–≤–∏–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏:

Multilingual (Russian) multimodal (text+img) multiimage (many images) captioning with masking 

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞:
                                                –ø–æ—Ç–æ–º —ç—Ç–æ —É–±—Ä–∞—Ç—å: (–¥–µ–ª–∞–µ–º –ø—Ä–æ—Å—Ç–æ –Ω–∞ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–π)
                                                –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é –º–æ–¥–µ–ª—å (–ù–ê–ó–í–ê–ù–ò–ï –ü–ê–ü–ö–ò –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Å —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏)
  +----------------+                                           +----------------------------------------------+                                            0. –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  |   User Input   | ----------------------------------------> | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å" |----------------------->   –ë–ª–æ–∫ –º–æ–¥–µ—Ä–∞—Ü–∏–∏   1. –ú–æ–¥–µ—Ä–∞—Ü–∏—è —Ñ–æ—Ç–æ,     notAI-tech/NudeNet                             
  +----------------+                                           +----------------------------------------------+                                |           2. –º–æ–¥–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞    unitary/toxic-bert (multilingual) / cointegrated/rubert-tiny-toxicity,
                                                                                      |                                                        |           3. –º–æ–¥–µ—Ä–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–æ—Ç–æ-—Ç–µ–∫—Å—Ç    ruCLIP                          
  {'–í–∏–¥ –æ–¥–µ–∂–¥—ã': '–î–ª—è –¥–µ–≤–æ—á–µ–∫',                                                       V                                                        V                                                                                                       
   '–ü—Ä–µ–¥–º–µ—Ç –æ–¥–µ–∂–¥—ã': '–û–±—É–≤—å',                                             +-----------------------+                                     –ë–ª–æ–∫  –º–æ–¥–µ—Ä–∞—Ü–∏–∏  -------------------------------------------> –î–∞. –£—Å–ø–µ—à–Ω–æ.
   '–°–æ—Å—Ç–æ—è–Ω–∏–µ': '–ù–æ–≤—ã–π',                                                  | User Input –Ω–µ –ø—É—Å—Ç–æ–π? |                                     –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ?                                                 |                                             
   '–í–∏–¥ –æ–±—ä—è–≤–ª–µ–Ω–∏—è': '–¢–æ–≤–∞—Ä –ø—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω –Ω–∞ –ø—Ä–æ–¥–∞–∂—É',                       +-----------------------+                                            |                                                         V
   '–†–∞–∑–º–µ—Ä': '30 (19 —Å–º)',                                                            |                                                        V                                              –ß—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª?                                
   '–¶–µ–Ω–∞': '5000', ...                                                                V                                                       –ù–µ—Ç.                                                       |                                                                                                                                                                      ** –î–õ–Ø –ù–ï–ö –ü–û–î–•–û–î–û–í –≤ –µ–¥–∏–Ω—ã–π –±–ª–æ–∫     
  }                                                                       +-----------------------+                                            |                                                         ------------------------> –ú–Ω–æ–≥–æ –∫–∞—Ä—Ç–∏–Ω–∫–æ–∫ –∏ —Ç–µ–∫—Å—Ç -----------------+
                                                                          |        –ü—É—Å—Ç–æ–π.        |                                            V                                                         |                                                                  |---> –ú–∞–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö <PRICE>, <SIZE>, ...  ---> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ -----> MultiImage Model----------------> –ó–∞–º–µ–Ω–∞ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ __, –µ—Å—Ç—å –Ω–æ–≤—ã–µ? —Å—Ç–µ—Ä–µ—Ç—å. –∫–∞–∫–∏—Ö-—Ç–æ –Ω–µ—Ç? –Ω—É, —É–≤—ã ----> Output ------> {–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –≤—Ä–µ–º—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏, –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —Å—Ä–µ–¥–Ω—è—è/–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫/–∫–∞—Ä—Ç–∏–Ω–æ–∫ –º–µ–∂–¥—É —Å–æ–±–æ–π/–∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ (ruCLIP, BERTScore) }
    +                                                                     +-----------------------+                                    –û—à–∏–±–∫–∞. –ù–∞–ø–æ–º–Ω–∏—Ç—å –æ                                               ------------------------> –ú–Ω–æ–≥–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –±–µ–∑ —Ç–µ–∫—Å—Ç–∞----------------+
                                                                                                                                       –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞.                                               |
                                                                                      |                                                                                                                  ------------------------> –¢–µ–∫—Å—Ç –±–µ–∑ –∫–∞—Ä—Ç–∏–Ω–æ–∫---------------------------> –ú–∞–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö <PRICE>, <SIZE>, ...    -----> SingleImage Model--------------->   –ó–∞–º–µ–Ω–∞ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ __, –µ—Å—Ç—å –Ω–æ–≤—ã–µ? —Å—Ç–µ—Ä–µ—Ç—å. –∫–∞–∫–∏—Ö-—Ç–æ –Ω–µ—Ç? –Ω—É, —É–≤—ã —Ö----> Output ------> {–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –≤—Ä–µ–º—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏, –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —Å—Ä–µ–¥–Ω—è—è/–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫/–∫–∞—Ä—Ç–∏–Ω–æ–∫ –º–µ–∂–¥—É —Å–æ–±–æ–π/–∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ (ruCLIP, BERTScore) }
  –ö–∞—Ä—Ç–∏–Ω–∫–∏                                                                            V
  - –¥–æ 10 —à—Ç—É–∫                                                   –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—è
  - —Ñ–æ—Ä–º–∞—Ç: jpg (jpeg), png, gif                                 –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤
  - —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–π: –¥–æ 25 –º–±                                      (–¢–ï–°–¢-–ö–ï–ô–°–´ - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Å —Ç–µ—Å—Ç–∞–º–∏)
                                                                –ö–µ–π—Å 1.1 –û–¥–Ω–æ —Ñ–æ—Ç–æ, –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç
                                                                –ö–µ–π—Å 1.2 –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ, –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç
                                                                –ö–µ–π—Å 2.1 –ú–Ω–æ–≥–æ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è
                                                                –ö–µ–π—Å 3.1 –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –Ω–∞ —Ñ–æ—Ç–æ
                                                                –ö–µ–π—Å 3.2 –†–∞–∑–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ (–Ω–∞–±–æ—Ä —Å—Ç—É–ª—å–µ–≤)
                                                                –ö–µ–π—Å 3.3 –ú–Ω–æ–≥–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                                                                –ö–µ–π—Å 4 –ö–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Ç–µ–∫—Å—Ç—É   - –æ—à–∏–±–∫–∞
                                                                –ö–µ–π—Å 5 –¢–µ–∫—Å—Ç –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞—Ä—Ç–∏–Ω–∫–µ    - –æ—à–∏–±–∫–∞
                                                                –ö–µ–π—Å 6 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ —Ç–µ–∫—Å—Ç—É       - –º–æ–¥–µ–ª—å —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–µ–∑ –∫–∞—Ä—Ç–∏–Ω–∫–∏ 
                                                                –ö–µ–π—Å 7 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–µ     - –º–æ–¥–µ–ª—å —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–µ–∑ —Ç–µ–∫—Å—Ç–∞
                                                                –ö–µ–π—Å 8 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º    - –º–æ–¥–µ–ª—å, —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏, –±–µ–∑ —Ç–µ–∫—Å—Ç–∞
  






1. –î–æ–¥–µ–ª–∞—Ç—å EDA (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–µ, –æ –º–µ—Ç—Ä–∏–∫–∞—Ö, –æ —Ä–µ—à–µ–Ω–∏—è—Ö –ø—Ä–æ–±–ª–µ–º, —Å–æ–±—Ä–∞—Ç—å –º–∞—Å–∫–∏). –ü–û–ú–ï–ß–ï–ù–û –ó–ù–ê–ö–û–ú - üî¥
2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞ —Å–µ—Ä–≤–∏—Å–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏

–û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞:

–ò—Ç–µ—Ä–∞—Ü–∏—è 1. –ù–∞–ª–∞–∂–∏–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ - –í–°–¢–†–û–ò–¢–¨ –î–í–ê –ü–ê–ô–ü–õ–ê–ô–ù–ê –ë–ï–ó –û–ë–£–ß–ï–ù–ò–Ø
- –ò—Å—Ö–æ–¥–Ω—ã–µ –º–æ–¥–µ–ª–∏ - tuman/vit-rugpt2-image-captioning (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–≤–∏—Ç–æ —Å–µ–π—á–∞—Å),
                  - ruDolph (–æ—Ç —Å–±–µ—Ä–∞, –∫–∞–∫ —Ç–∞ —á—Ç–æ –≤—ã—à–µ, –Ω–æ –Ω–æ–≤–µ–µ –∏ –∂–∏–≤–µ–µ) –ü–û–°–¢–†–ê–¢–¨–°–Ø –ù–ï –ß–ï–†–ï–ó –ê–ü–ò

- –ò–∑ –≤—Å–µ—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–¥–Ω–∞ (CLIPScore - ruCLIP) –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ç–µ–∫—Å—Ç



–ò—Ç–µ—Ä–∞—Ü–∏—è 2. –°–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä diversity 

1) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (float diversity_score –æ—Ç 0 –¥–æ 1)
     –ï—Å–ª–∏ –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –º–Ω–æ–≥–æ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —Ç–æ –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ diversity=1.
     1.1) –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–º–µ—Ç–∏—Ç—å –ø–æ–ª—É—Ä—É—á–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º (—Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ –ø–æ —Ç–µ–∫—Å—Ç—É)
          –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω –ø—Ä–∏–º–µ—Ä–æ–≤ (500+) - (–Ω–∞–ø—Ä–∏–º–µ—Ä, 250 —Å diversity=1 –∏ 250 —Å diversity=0).
          –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å accuracy > 0.9 
     1.2) –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫ –æ–±–æ–∏–º –¥–∞—Ç–∞—Å–µ—Ç–∞–º (–Ω–æ–≤–æ–º—É –∏ —Å—Ç–∞—Ä–æ–º—É) –∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É diversity_score

     –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ:

     1.1) –í–∑—è—Ç—å ruCLIP –∏ –ø–æ–¥–∞—Ç—å –µ–º—É —Ñ–æ—Ç–∫—É –∏ –¥–≤–∞ —Å–ø–∏—Å–∫–∞ –æ–ø–∏—Å–∞–Ω–∏–π:
          - variative = ['—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ç–æ–≤–∞—Ä–æ–≤', '–º–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤', '–º–Ω–æ–≥–æ –≤–µ—â–µ–π']
          - single = ['–æ–¥–∏–Ω —Ç–æ–≤–∞—Ä', '–ø—Ä–æ–¥—É–∫—Ç', '–æ–¥–Ω–∞ —à—Ç—É–∫–∞']
          - –ø–æ—Å—á–∏—Ç–∞–ª 6 CLIP-similarities, –≤–∑—è–ª —É –Ω–∏—Ö —Å—Ä–µ–¥–Ω–µ–µ, –ø–æ–ª—É—á–∏–ª –ø—Ä–∏–∑–Ω–∞–∫ 

     –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏—Ö

     –æ–∂–∏–¥–∞–µ—Ç—Å—è -> –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

2) –í—ã–±—Ä–∞–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥—É—Ç –ø–æ–ª—É—á–µ–Ω—ã –º–µ—Ç–∫–∏ diversity_score –¥–ª—è –≤—Å–µ—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
   –≤ –º–æ–¥–µ–ª—å –±—É–¥—É—Ç –ø–æ–¥–∞–≤–∞—Ç—å—Å—è –∫–∞–∫ —Å–∫—Ä—ã—Ç—ã–µ —Ç–æ–∫–µ–Ω—ã  <VARIATIVE> –∏ <SINGLE>
  
–ò—Ç–µ—Ä–∞—Ü–∏—è 3. –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–∫—Ä—ã—Ç—ã–µ —Ç–æ–∫–µ–Ω—ã - <SINGLE> –∏ <VARIATIVE>

–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ —Ü–∏—Ñ—Ä—ã –Ω–∞ placeholders
     –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <PRICE>, <SIZE>), –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º,
     –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω <UNK_VAL> –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–æ–≥–ª–∏ –Ω–µ —É–≤–∏–¥–µ—Ç—å 
     —Ä–∞–Ω–Ω–µ–µ.
     –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞ —á—Ç–æ –∑–∞–º–µ–Ω—è—Ç—å –ø–æ —Å–ª–æ–≤–∞–º –ø–µ—Ä–µ–¥ —Ü–∏—Ñ—Ä–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä,
     <PRICE> - —Ü–µ–Ω–∞, <SIZE> - —Ä–∞–∑–º–µ—Ä –∏ —Ç.–¥.)


===============================================================================
–î–û –°–û–ó–í–û–ù–ê –£–ñ–ï –ì–û–¢–û–í–û ^^^^^
===============================================================================

–ò—Ç–µ—Ä–∞—Ü–∏—è 4. –°–æ–∑–¥–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç —Å –º–Ω–æ–≥–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤–æ—Å—Ç—å—é

–ú—É–ª—å—Ç–∏–∫–∞—Ä—Ç–∏–Ω–æ—á–Ω–æ—Å—Ç—å –¥–µ–ª–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ - TempoFunk/webvid-10M

–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å multi-image-caption –∏–∑ –≤–∏–¥–µ–æ-–¥–∞—Ç–∞—Å–µ—Ç–∞ - video+caption
–°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç (–∏–ª–∏ —á–∞—Å—Ç—å) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, TVSum.
–†–∞–∑–±–∏—Ç—å –∫–∞–∂–¥–æ–µ –≤–∏–¥–µ–æ –Ω–∞ N —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5‚Äì10 —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤).
–ü—Ä–∏–º–µ—Ä: –∫–∞–∂–¥—ã–µ X —Å–µ–∫—É–Ω–¥ –∏–ª–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å summary –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∏–¥–µ–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ ‚Äúcaption‚Äù –¥–ª—è –Ω–∞–±–æ—Ä–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤.

–ì–æ—Ç–æ–≤–æ: [screenshot1, screenshot2, ..., screenshotN] ‚Üí summary.


–ù–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º? –ó–Ω–∞—á–∏—Ç –ø–µ—Ä–µ–≤–æ–¥–∏–º. 

—É –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–µ –∑–∞–±—ã—Ç—å –ø—Ä–æ diversity_score

!!! –í–ê–ñ–ù–û !!!
–í—ã—Ü–µ–ø–∏—Ç—å –æ—Ç—Å—é–¥–∞ 20% –Ω–∞ —Ç–µ—Å—Ç. 


--------------------------------------------------------------------------------------------------------------------------------------

–ò—Ç–µ—Ä–∞—Ü–∏—è 5. –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º –º–Ω–æ–≥–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤–æ—Å—Ç—å, –Ω–µ –∑–∞–±—ã—Ç—å –ø—Ä–æ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ diversity_score

0!!!!) OPEN FLAMINGO –§–†–ï–ô–ú–í–û–†–ö, –ë–ï–†–ï–®–¨ DECODER ONLY LM + VISION ENCODER (VIT) 
       https://github.com/mlfoundations/open_flamingo/tree/main

1-2 –º–æ–¥–µ–ª–∏) vit-rugpt2 –∏ ruDolph

–°–æ—Ñ—Ç –ø—Ä–æ–º–ø—Ç–∏–Ω–≥

  - –∫–∞–∂–¥–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ -> ViT -> –õ–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (768 -> 1024) ->
    -> softprompt (–≤–µ–∫—Ç–æ—Ä –¥–ª–∏–Ω—ã 1024) -> –¥–æ–±–∞–≤–ª—è–µ–º –≤ input_hidden_states
    –ø–µ—Ä–µ–¥ —Ç–µ–∫—Å—Ç–æ–º, –º–µ–∂–¥—É –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å —Å–ø–µ—Ü—Ç–æ–∫–µ–Ω—ã <IMG_i>

  - –õ–æ—Ä–∞ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç —Å –º–Ω–æ–≥–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤–æ—Å—Ç—å—é, –ê –ü–û–¢–û–ú –õ–û–†–ê –ù–ê –û–°–ù–û–í–ù–û–ô –î–ê–¢–ê–°–ï–¢

    https://github.com/ai-forever/ru-dolph/tree/master/jupyters

3 –º–æ–¥–µ–ª—å) Blip2 —Å –∑–∞–º–µ–Ω–µ–Ω–Ω–æ–π –ª–ª–º

  —Å–ø–æ—Å–æ–±—ã –º—É–ª—å—Ç–∏–∫–∞—Ä—Ç–∏–Ω–æ—á–Ω–æ—Å—Ç–∏:
  —Å–ø–æ—Å–æ–± 1. –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
  –∫–∞–∂–¥–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ ‚Üí ViT ‚Üí Q-Former ‚Üí —Ç–æ–∫–µ–Ω—ã ‚Üí –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –∏ –ø–æ–¥–∞—é—Ç—Å—è –≤ LLM.
  —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫. –Ω–∞—Ç–∏–≤–Ω–æ –¥–ª—è BLIP-2. LoRA –Ω–∞ Q-Former.
  —Å–ø–æ—Å–æ–± 2. ViT –Ω–∞ –ø–∞—á–∫—É
  –≤—Å–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å—Ä–∞–∑—É —Å–∫–∞—Ä–º–ª–∏–≤–∞—é—Ç—Å—è ViT –∫–∞–∫ –±–∞—Ç—á ‚Üí –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –≤—Ö–æ–¥ ‚Üí Q-Former.
  –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø—É—Ç–∞—Ç—å—Å—è. –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–∑–∏—Ü–∏–π. LoRA.

  –≤–∞—Ä–∏–∞–Ω—Ç—ã –±–ª–∏–ø-–±–∞–∑—ã:

- mBLIP2 + RuT5/RuBART 
 - how to change llm - —Å–º–æ—Ç—Ä–∏ –≤ —Ä–µ–ø–µ https://github.com/gregor-ge/mBLIP/issues/15

–ê –ü–û–¢–û–ú –õ–û–†–ê –ù–ê –û–°–ù–û–í–ù–û–ô –î–ê–¢–ê–°–ï–¢


4 –º–æ–¥–µ–ª—å) ruClipCap (based on ruCLIP + ruGPT)

- ruCLIPCAP+ –º–∞—Å–∫–∏ + –º–Ω–æ–≥–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤–æ—Å—Ç—å

RuCOCO -    https://github.com/AlexWortega/ru_COCO?ysclid=mavhtsid8m796392388
ClipCap -   https://github.com/rmokady/CLIP_prefix_caption
RuClipCap - https://github.com/rbeketov/clipcap-nas/tree/619f8d3c30d83d790306d067647333e5dbcb604a
          - ViT-B-16-plus-240, ruclip-vit-base-patch32-384, rugpt3medium_based_on_gpt2

- LoRA –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç —Å –º–Ω–æ–≥–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤–æ—Å—Ç—å—é

- LoRA –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç —Å –æ—Å–Ω–æ–≤–Ω—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º



–ò—Ç–µ—Ä–∞—Ü–∏—è 6. –í—ã–±–æ—Ä –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ–µ –≤ —Å–µ—Ä–≤–∏—Å–µ



–í–∞–∂–Ω—ã–µ –ø—Ä–∏–∫–æ–ª—ã:

---> –ß–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å –≤ –ª–æ—Å—Å–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π LoRa
      
      def similarity() = cosine_similarity / BERTScore

      pred = tokenizer.decode()
      human_descr = inputs["labels"]
      GPT4_descr = inputs["gpt_texts"]

      reward = cider(pred, human_descr) - Œ≤ * similarity(pred, GPT4_descr)
    ( –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ —á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å = –±–ª–∏–∑–æ—Å—Ç—å –∫ —á–µ–ª–æ–≤–µ–∫—É - Œ≤ * –±–ª–∏–∑–æ—Å—Ç—å –∫ GPT4 )
    
      LOSS -= Œ± * reward (Œ± - –≤–µ—Å —á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç–∏)


CIDEr - –Ω–∞—Å–∫–æ–ª—å–∫–æ –º—ã –ø–æ–ø–∞–ª–∏ –≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (0 –Ω–µ—Ç - 5 –±–µ–∑—É–º–Ω–æ —Ö–æ—Ä–æ—à–æ)
      BERTScore - –Ω–∞—Å–∫–æ–ª—å–∫–æ –º—ã –ø–æ–ø–∞–ª–∏ –≤ GPT4 (0 –Ω–µ—Ç - 1 –º—ã –∫–∞–∫ GPT4, –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º —É –º–µ—Ç—Ä–∏–∫–∏ - BERT)
      cosine_similarity - –Ω–∞—Å–∫–æ–ª—å–∫–æ –º—ã –ø–æ–ø–∞–ª–∏ –≤ CLIP (0 –Ω–µ—Ç - 1 –±–µ–∑—É–º–Ω–æ —Ö–æ—Ä–æ—à–æ)


---> –ù–∞ –∫–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –∏ –Ω–∞ —Ç–µ—Å—Ç–µ?

CLIPScore –ø–æ mean –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç–µ–∫—Å—Ç (0 - 1)
  clip_mean_scores = [clipscore_mean(p, images[i]) for i, p in enumerate(pred_texts)]

BERTScore (vs Human, vs GPT)
- —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å —ç—Ç–∞–ª–æ–Ω–∞–º–∏ (0 - 1)
  bert_human = bertscore(pred_texts, human_refs)
	
CIDEr
- –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –ø–æ—Ö–æ–∂ –Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (0 - 5)  
  cider(pred_texts, human_refs) - Œ≤ * bert_gpt  –ù–∞—Å–∫–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ GPT4
  cider(pred_texts, gpt4_refs) - Œ≤ * bert_gpt  	–ê–Ω—Ç–∏-—á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å (–ø–∏—à–µ–º –∫–∞–∫ GPT ‚Äî –ø–ª–æ—Ö–æ)
      
–ß–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å
  cider(pred_texts, human_refs) - Œ≤ * bert_gpt

  [0, 5] - [0, 1] * [0, 1]

  => —á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 0 –¥–æ 5

–ö–ª–∞—Å—Å–∏–∫–∞
  BLEU-1,2,3,4 - –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ n-–≥—Ä–∞–º–º–∞–º. –û—Ü–µ–Ω–∫–∞ –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è.
  ROUGE-L - –£—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –æ–±—â—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–µ–∂–¥—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º.
  METEOR - –ë–æ–ª–µ–µ "–≥—É–º–∞–Ω–Ω–∞—è" –º–µ—Ç—Ä–∏–∫–∞, —É—á–∏—Ç—ã–≤–∞—é—â–∞—è —Å–∏–Ω–æ–Ω–∏–º—ã –∏ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—é.
        

---> –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–º–æ–∂–µ–º –ø–æ—Ç–æ–º –æ—Ç–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–µ –∑–Ω–∞—è —ç—Ç–∞–ª–æ–Ω—ã?

    "clipscore_mean": average(CLIP(imgs), caption), –°—Ä–µ–¥–Ω—è—è —Å—Ö–æ–∂–µ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ —Å–æ –≤—Å–µ–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–ø–æ CLIP)
    "clipscore_max": max(CLIP(imgs), caption), –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ —Å –æ–¥–Ω–∏–º –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ CLIP)



















--------------------------------------–ü–õ–ê–ù–ò–†–û–í–ê–õ–û–°–¨---------------------------------------------

–°–æ–∑–¥–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É—á–∏—Ç—å –º–æ–¥–µ–ª–∏ –º–Ω–æ–≥–æ–∫–∞—Ä—Ç–∏–Ω–æ—á–Ω–æ—Å—Ç–∏ 
  (—á–∞—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–æ–∫ - –æ–¥–Ω–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤—ã–µ, —á–∞—Å—Ç—å - —Ä–µ–∞–ª—å–Ω—ã–µ –º—É–ª—å—Ç–∏–∫–∞—Ä—Ç–∏–Ω–∫–∏, —Ç—Ä–µ—Ç—å—è —á–∞—Å—Ç—å -
   –∫–æ–ø–∏–∏ –æ–¥–Ω–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ —Å —Ä–∞–∑–Ω—ã–º–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è–º–∏. –ø—Ä–∏ —ç—Ç–æ–º –¥–æ–ª–∂–Ω—ã 
   –±—ã—Ç—å –≤—Å–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ (–æ–¥–µ–∂–¥–∞))

   –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç: 
   –í—Å–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π: 37441, 
   —É 32839 –∏–∑ –Ω–∏—Ö –µ—Å—Ç—å –±–æ–ª—å—à–µ 1 –∫–∞—Ä—Ç–∏–Ω–∫–∏, 
   —á–∞—â–µ –≤—Å–µ–≥–æ 3 –∫–∞—Ä—Ç–∏–Ω–∫–∏ - 9829 —Ä–∞–∑.
   –≤—Å–µ–≥–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫  117329

   +

   –¥–∞—Ç–∞—Å–µ—Ç MLCUP (–æ–¥–Ω–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤—ã–π)
   –û–±—ä—è–≤–ª–µ–Ω–∏–π –±–æ–ª—å—à–µ 2.3 –º–ª–Ω


–î–∞—Ç–∞—Å–µ—Ç –≤ —Å—É–º–º–µ –±—É–¥–µ—Ç —Ç–∞–∫–∏–º:

–ò—Å—Ç–æ—á–Ω–∏–∫ 1: –û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç
–ö–∞—Ç–µ–≥–æ—Ä–∏—è	                                        –°—Ç—Ä–æ–∫ (–æ–±—ä—è–≤–ª–µ–Ω–∏–π)	   –ö–∞—Ä—Ç–∏–Ω–æ–∫	      –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
MULTI_REAL (multi ‚â•2 image)	                      32‚ÄØ839	               117‚ÄØ329	      –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é
SINGLE_MAIN (—Å 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º)	                  4‚ÄØ602	                 4‚ÄØ602	        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é
AUG_MAIN (–∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è SINGLE_MAIN, ~2.5√ó)	        5‚ÄØ000	                 ~12‚ÄØ500	      –°–µ–º–ø–ª –∏–∑ SINGLE_MAIN, —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π
–í—Å–µ–≥–æ	                                            42‚ÄØ441	               ~134‚ÄØ431	

–ò—Å—Ç–æ—á–Ω–∏–∫ 2: MLCUP (–æ–¥–Ω–æ–∫–∞—Ä—Ç–∏–Ω–∫–æ–≤—ã–π)
–ö–∞—Ç–µ–≥–æ—Ä–∏—è	                                        –°—Ç—Ä–æ–∫ (–æ–±—ä—è–≤–ª–µ–Ω–∏–π)	    –ö–∞—Ä—Ç–∏–Ω–æ–∫	      –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
SINGLE_MLCUP (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)	                    15‚ÄØ000	                15‚ÄØ000	        –°–µ–º–ø–ª –∏–∑ 2.3 –º–ª–Ω
AUG_MLCUP (–∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, ~2.5√ó)	                  10‚ÄØ000	                ~25‚ÄØ000	        –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π multi –∏–∑ –æ–¥–∏–Ω–æ—á–µ–∫
–í—Å–µ–≥–æ	                                            25‚ÄØ000	                ~40‚ÄØ000	
